#region Portable Generators
# Base generator for powered on, anchored versions for shuttles
- type: entity
  id: BaseGeneratorShuttle
  abstract: true
  components:
  - type: Transform
    anchored: true
  - type: Physics
    bodyType: Static
  - type: PortableGenerator
    startOnMapInit: true

- type: entity
  parent:
  - BaseGeneratorShuttle
  - PortableGeneratorPacman
  id: PortableGeneratorPacmanShuttle
  suffix: Plasma, 15 kW, Ship
  components:
  - type: MaterialStorage
    storage:
      FuelGradePlasma: 1000

- type: entity
  parent:
  - BaseGeneratorShuttle
  - PortableGeneratorSuperPacman
  id: PortableGeneratorSuperPacmanShuttle
  suffix: Uranium, 30 kW, Ship
  components:
  - type: MaterialStorage
    storage:
      FuelGradeUranium: 1000

- type: entity # Coyote tweaked
  parent:
  - BaseGeneratorShuttle
  - PortableGeneratorJrPacman
  id: PortableGeneratorJrPacmanShuttle
  suffix: Welding Fuel, 6 kW, Ship
  components:
    - type: SolutionContainerManager
      solutions:
        tank:
          maxVol: 400
          reagents:
          - ReagentId: WeldingFuel
            Quantity: 140

#region D-K
- type: entity # Coyote tweaked
  name: D-K portable generator
  description: |-
    A prototype Dunn-Kikko fission reactor. Use with caution.
    Runs off bananium and is rated for up to 140 kW.
    Highly radioactive without protection.
  parent:
  - PortableGeneratorSuperPacman
  - BaseC1Contraband
  id: PortableGeneratorDK
  suffix: Bananium, Rad+, 40-140(80) kW
  components:
    - type: Sprite
      sprite: _NF/Structures/Power/Generation/portable_generator.rsi
      layers:
        - state: portgen1
          map: [ "enum.GeneratorVisualLayers.Body" ]
        - state: portgen_on_unlit
          map: [ "enum.GeneratorVisualLayers.Unlit" ]
          shader: unshaded
          visible: false
    - type: GenericVisualizer
      visuals:
        enum.GeneratorVisuals.Running:
          enum.GeneratorVisualLayers.Body:
            True: { state: portgen1on }
            False: { state: portgen1 }
          enum.GeneratorVisualLayers.Unlit:
            True: { visible: true }
            False: { visible: false }
    - type: Machine
      board: PortableGeneratorDKMachineCircuitboard
    - type: FuelGenerator
      minTargetPower: 40000
      maxTargetPower: 140000
      targetPower: 80000
      optimalPower: 80000
      optimalBurnRate: 0.0075
      clockstepConstant: 25000
      radiationColor: "#00bfff"
    - type: SolidFuelGeneratorAdapter
      fuelMaterial: FuelGradeBananium
    - type: MaterialStorage
      materialWhiteList: [Bananium, FuelGradeBananium, RawBananium, Skrungle]
    - type: PowerMonitoringDevice
      sprite: _NF/Structures/Power/Generation/portable_generator.rsi
      state: portgen1
    - type: RadiationSource
      enabled: false
    - type: PowerSupplier
      supplyRampRate: 10000
      supplyRampTolerance: 3000
    - type: FuelGradeAdapter
      conversions:
      - input: Bananium
        output: FuelGradeBananium
        rate: 1
      - input: RawBananium
        output: FuelGradeBananium
        rate: 0.5
      - input: Skrungle
        output: FuelGradeBananium
        rate: 0.25
    - type: Geiger
      showExamine: true
      broadcastAudio: true
      isEnabled: true
      attachedToSuit: true # Prevents the counter from being disabled.
    - type: RadiationReceiver # For the geiger counter

- type: entity
  parent:
  - BaseGeneratorShuttle
  - PortableGeneratorDK
  id: PortableGeneratorDKShuttle
  suffix: Bananium, Rad+, 80 kW, Ship
  categories: [ HideSpawnMenu ] # Mm, start-on rad source
  components:
    - type: MaterialStorage
      storage:
        FuelGradeBananium: 1000

#region D-K Jr.
- type: entity # Coyote tweaked
  name: D-K Jr. portable generator
  description: |-
    A miniaturized Dunn-Kikko fission reactor. Use with caution.
    Runs off bananium and is rated for up to 100 kW.
    Quite radioactive without protection.
  parent:
  - PortableGeneratorDK
  - BaseC1Contraband
  id: PortableGeneratorDKJr
  suffix: Bananium, Rad-, 20-90(60) kW
  components:
    - type: Sprite
      sprite: Structures/Power/Generation/portable_generator.rsi
      layers:
        - state: portgen2
          map: [ "enum.GeneratorVisualLayers.Body" ]
        - state: portgen_on_unlit
          map: [ "enum.GeneratorVisualLayers.Unlit" ]
          shader: unshaded
          visible: false
    - type: GenericVisualizer
      visuals:
        enum.GeneratorVisuals.Running:
          enum.GeneratorVisualLayers.Body:
            True: { state: portgen2on }
            False: { state: portgen2 }
          enum.GeneratorVisualLayers.Unlit:
            True: { visible: true }
            False: { visible: false }
    - type: Machine
      board: PortableGeneratorDKJrMachineCircuitboard
    - type: FuelGenerator
      minTargetPower: 20000
      maxTargetPower: 90000
      targetPower: 60000
      optimalPower: 60000
      clockstepConstant: 20000
      radiationIntensity: 0.00004 # 3.6 rad/s at full output, 2.4 at optimal settings
    - type: PowerMonitoringDevice
      sprite: Structures/Power/Generation/portable_generator.rsi
      state: portgen2

- type: entity
  parent:
  - BaseGeneratorShuttle
  - PortableGeneratorDKJr
  id: PortableGeneratorDKJrShuttle
  suffix: Bananium, Rad-, 60 kW, Ship
  components:
    - type: MaterialStorage
      storage:
        FuelGradeBananium: 1000
